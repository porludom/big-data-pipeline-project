0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team19_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP TABLE IF EXISTS q1_results;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE q1_results(
. . . . . . . . . . . . . . . . . . . . . . .>     Moon_Phase STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     Avg_Temperature_Celsius FLOAT,
. . . . . . . . . . . . . . . . . . . . . . .>     Avg_Moon_Phase FLOAT
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED 
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY ',' 
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION 'project/hive/warehouse/q1';
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.resultset.use.unique.column.names = false;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO TABLE q1_results
. . . . . . . . . . . . . . . . . . . . . . .> SELECT
. . . . . . . . . . . . . . . . . . . . . . .>     moon_phase,
. . . . . . . . . . . . . . . . . . . . . . .>     AVG(temperature_celsius) AS avg_temp,
. . . . . . . . . . . . . . . . . . . . . . .>     AVG(humidity) AS avg_humidity
. . . . . . . . . . . . . . . . . . . . . . .> FROM astronomical_data_part ast
. . . . . . . . . . . . . . . . . . . . . . .> JOIN weather_conditions w ON ast.location_id = w.location_id
. . . . . . . . . . . . . . . . . . . . . . .> GROUP BY moon_phase;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT *
. . . . . . . . . . . . . . . . . . . . . . .> FROM q1_results;
+-------------+--------------------------+-----------------+
| moon_phase  | avg_temperature_celsius  | avg_moon_phase  |
+-------------+--------------------------+-----------------+
| 0           | 19.478376                | 70.74701        |
| 1           | 20.10834                 | 69.65234        |
| 10          | 18.710512                | 69.528206       |
| 100         | 19.46492                 | 69.29944        |
| 11          | 19.54923                 | 73.74872        |
| 12          | 17.44923                 | 68.24359        |
| 13          | 19.829744                | 68.1            |
| 14          | 22.26923                 | 73.8359         |
| 15          | 16.914654                | 71.48329        |
| 16          | 19.049744                | 65.49231        |
| 17          | 16.350513                | 71.88718        |
| 18          | 20.08988                 | 70.274445       |
| 2           | 18.368847                | 70.684616       |
| 20          | 19.700384                | 67.9            |
| 22          | 21.294529                | 71.365814       |
| 23          | 16.293846                | 69.379486       |
| 24          | 18.259487                | 70.8359         |
| 25          | 16.64                    | 73.28205        |
| 26          | 18.058804                | 69.32478        |
| 27          | 21.065641                | 70.92821        |
| 28          | 21.238205                | 67.70513        |
| 3           | 19.02111                 | 71.22137        |
| 30          | 19.957052                | 68.11667        |
| 31          | 22.145876                | 73.798965       |
| 32          | 18.049488                | 69.21026        |
| 34          | 17.253077                | 73.41282        |
| 35          | 19.702564                | 73.184616       |
| 36          | 20.457949                | 66.63333        |
| 37          | 18.64795                 | 72.03333        |
| 38          | 21.41641                 | 63.25128        |
| 39          | 22.598461                | 72.31282        |
| 4           | 20.489176                | 62.706184       |
| 40          | 18.204103                | 67.34872        |
| 41          | 20.127615                | 68.66724        |
| 42          | 16.867693                | 71.53333        |
| 43          | 17.735897                | 71.55641        |
| 44          | 19.66154                 | 72.94359        |
| 45          | 18.55641                 | 72.54872        |
| 46          | 20.547815                | 66.385605       |
| 48          | 19.620512                | 68.50598        |
| 49          | 22.708204                | 72.16923        |
| 5           | 17.68718                 | 73.499146       |
| 50          | 17.872307                | 66.37436        |
| 51          | 19.549585                | 65.89474        |
| 52          | 19.397436                | 72.551285       |
| 53          | 18.29282                 | 71.09231        |
| 54          | 18.894873                | 67.38461        |
| 56          | 19.907692                | 71.18718        |
| 57          | 19.331282                | 63.85128        |
| 58          | 21.10464                 | 63.685566       |
| 59          | 16.567692                | 70.36923        |
| 6           | 18.335897                | 68.17179        |
| 60          | 21.63282                 | 72.97692        |
| 61          | 17.357435                | 71.74359        |
| 62          | 22.966154                | 57.923077       |
| 63          | 20.653847                | 73.13333        |
| 64          | 17.524872                | 68.95641        |
| 65          | 21.537436                | 70.51795        |
| 66          | 19.133333                | 66.44615        |
| 67          | 17.901539                | 70.45641        |
| 68          | 20.899487                | 62.317947       |
| 69          | 16.410769                | 69.68974        |
| 7           | 21.266666                | 72.45641        |
| 70          | 19.569231                | 72.79744        |
| 71          | 18.40436                 | 72.53333        |
| 72          | 21.408718                | 66.15897        |
| 74          | 19.012136                | 70.44786        |
| 75          | 20.242893                | 67.94574        |
| 77          | 18.90641                 | 66.489746       |
| 78          | 17.257437                | 69.69231        |
| 79          | 19.106411                | 70.66154        |
| 8           | 19.687988                | 70.69713        |
| 80          | 22.666153                | 60.08718        |
| 81          | 20.244871                | 73.95128        |
| 82          | 18.444616                | 66.88205        |
| 83          | 18.262564                | 67.39231        |
| 84          | 20.380928                | 69.25387        |
| 85          | 16.925129                | 72.77949        |
| 86          | 16.98906                 | 69.815384       |
| 88          | 21.518803                | 69.76923        |
| 89          | 19.385641                | 70.47692        |
| 9           | 15.805128                | 71.12308        |
| 90          | 18.394102                | 69.19231        |
| 91          | 19.65118                 | 70.941536       |
| 92          | 16.932308                | 74.93846        |
| 93          | 20.241539                | 65.76667        |
| 94          | 20.367008                | 72.0171         |
| 95          | 19.19295                 | 68.42179        |
| 96          | 19.037949                | 72.50769        |
| 97          | 19.460384                | 69.46667        |
| 98          | 19.400074                | 69.60497        |
| 99          | 18.972727                | 72.63123        |
+-------------+--------------------------+-----------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 